#!/usr/bin/env python3

import tensorflow as tf

import json
import os
import time
import warnings
import random

import h5py
import matplotlib.pyplot as plt
import matplotlib.patches as patches
import numpy as np
import pandas as pd
import pysam
import pyfaidx
import tensorflow as tf

from baskerville import seqnn
from baskerville import gene as bgene
from baskerville import dna

from borzoi_helpers import *



tf.compat.v1.logging.set_verbosity(tf.compat.v1.logging.ERROR)

def main():
    # SET THIS TO DIRECTORY CONTAINING 'examples/saved_models/f0/model0_best.h5' ETC
    borzoi_dir = '.'
    ref_path = 'Homo_sapiens.GRCh38.dna.toplevel.fa'

    n_folds = 4
    rc = True
    seq_len = 524288
    PRED_WIDTH = seq_len - (16 * 32) - (16 * 32)
    OUT_N_BINS = (PRED_WIDTH // 32)
    params_file = 'params_pred.json'
    targets_file = 'targets_gtex.txt'

    #Read model parameters
    with open(params_file) as params_open :
        params = json.load(params_open)
        params_model = params['model']
        params_train = params['train']

    targets_df = pd.read_csv(targets_file, index_col=0, sep='\t')
    target_index = targets_df.index
    targets_df['local_index'] = np.arange(len(targets_df))


    #Create local index of strand_pair (relative to sliced targets)
    if rc :
        strand_pair = targets_df.strand_pair
        target_slice_dict = {ix : i for i, ix in enumerate(target_index.values.tolist())}
        slice_pair = np.array([
            target_slice_dict[ix] if ix in target_slice_dict else ix for ix in strand_pair.values.tolist()
        ], dtype='int32')

    #Initialize model ensemble
    models = []
    for fold_ix in range(n_folds) :
        model_file = borzoi_dir + "examples/saved_models/f" + str(fold_ix) + "/model0_best.h5"
        seqnn_model = seqnn.SeqNN(params_model)
        seqnn_model.restore(model_file, 0)
        seqnn_model.build_slice(target_index)
        if rc :
            seqnn_model.strand_pair.append(slice_pair)
        seqnn_model.build_ensemble(rc, '0')
        models.append(seqnn_model)

    fasta_open = pysam.Fastafile(ref_path)

    otx2_wt_seq = fasta_open.fetch('14', 56669000, 57193288)
    otx2_wt_seq_long = fasta_open.fetch('14', 56669000, 58700000)

    site_locs = [56669000, 56884634, 56893129, 56898376, 56901292, 56903183, 56904792, 56907608]
    site_locs_adj = [i - 56669000 for i in site_locs]

    deletions_dict = {'del12': [(1,2)],
                      'del13': [(1,3)],
                      'del14': [(1,4)],
                      'del15': [(1,5)],
                      'del16': [(1,6)],
                      'del17': [(1,7)],
                      'del23': [(2,3)],
                      'del24': [(2,4)],
                      'del27': [(2,7)],
                      'del34': [(3,4)],
                      'del35': [(3,5)],
                      'del36': [(3,6)],
                      'del37': [(3,7)],
                      'del47': [(4,7)],
                      'del57': [(5,7)],
                      'del12_del34': [(1,2), (3,4)],
                      'del12_del36': [(1,2), (3,6)],
                      'del12_del37': [(1,2), (3,7)],
                      'del12_del47': [(1,2), (4,7)],
                      'del12_del67': [(1,2), (6,7)],
                      'del13_del47': [(1,3), (4,7)],
                      'del13_del67': [(1,3), (6,7)],
                      'del14_del57': [(1,4), (5,7)],
                      'del14_del67': [(1,4), (6,7)],
                      'del23_del47': [(2,3), (4,7)],
                      'del24_del57': [(2,4), (5,7)]}

    del_seqs = {}

    for del_name in deletions_dict.keys():
        curr_dels = deletions_dict[del_name]
        if len(curr_dels) == 1:
            site1 = site_locs_adj[curr_dels[0][0]]
            site2 = site_locs_adj[curr_dels[0][1]]
            del_seqs[del_name] = otx2_wt_seq_long[:site1] + otx2_wt_seq_long[site2:]
            del_seqs[del_name] = del_seqs[del_name][:524288]
        elif len(curr_dels) == 2:
            site1 = site_locs_adj[curr_dels[0][0]]
            site2 = site_locs_adj[curr_dels[0][1]]
            site3 = site_locs_adj[curr_dels[1][0]]
            site4 = site_locs_adj[curr_dels[1][1]]
            del_seqs[del_name] = otx2_wt_seq_long[:site1] + otx2_wt_seq_long[site2:site3] + otx2_wt_seq_long[site4:]
            del_seqs[del_name] = del_seqs[del_name][:524288]
        else:
            print(f'too many dels, not including {del_name}')

    extra_seq = 'GATCAAAACACTCTGCAGCCGTCATGAGAAAAAGTCAGAACAGCTGACAACTAGTACACGTACATAACTTTGCTCATTATCCCCATTCTATCAAATATATACATAGTAAGAAAATTTTTAAGAGAAAGAAAAATCAAATGGCTTGGCCATTGTTCTTTGAGCAGCATCAAAGCTCCAGCAGTGATTTTCCAAGCCAGGAGTCCCCTCTCTTCAGGCTGATCCCCTTGTTTCACAGCTCTTTGGCTCTTACCTCTGTCCATAGAGTGACCTACACCTCACCTCTGCCCTGTTGCCATCTAACATATAGTTCTTATGAACAGCTGGCTCCCCAGAGACTTTCAATGTCTTCCTGTTAATCTTCTGTTTGCTCTCTTGAGGCATGGGAGCTAATTATGCAGATTAAGAAGATATTTACCAAAACTCAAACTTCCTTAAAATTCAACTTTTTTAGGAGAACAAGTTTATTAATTTGATCACTGTCAGTATTTCAAGATTCATCTTATTGGCCTTGTCAGATGATAAAACAGTTATGACCTATCCATTGCAAAAATGTAGATGATggctgggcatggtggttcacgcctataatcccagtattttgggaggctaaagcaggtgatcacctgaggtcaggagtttgaaaccagcctagccaacatggtgaaactccatttccacgaaaaatacaaaaatgagctgggtgtggttgtgggtgcctgtaaacccagctacttgggaggcgggggcaggagaatcacttgaacccaggaggtggaggttgcagtgagccaagatcgcaccattgcattccagcctgggcagcaagagcaaaattctgtctcaaaaaaaaaaaaaaaGTGGGTGACAGAAAGATATTACTGTTTTCTTGTAACTACAGGTTTGATCCATCTTCTTGGGAATCTGTGGCCAATGAAGAAATGTGGCAAGCGAGGTGACTATTCTACATTTTTGTGTGTGCAGTCTATTTTTAATATGGCAGGGAAGTAGCTTATGGCACTTTTAATTTTGAGAGTAGGGGTGAGTAGTGataataaaaatagcatttatgagcaattatgtttttgaggcactgtactaatcattatacatgaatatttcagttcatccacacaataacctctgaggttattttgatccccattttataaaagaacaaactggatgtggaaaggctacttgtccaagggcacactgctgctagtgatggagtccaaagttcacatctgtctgcctCTGGAACACTCATCTAACTAAAGTGAGTGTAATCGATTGAGTAGAAATTAATCATTACAACCTCGCCTCCATTTGTAATGTGCCTGTCAATTAGTTaagcacttattcagtacttactggaggccaggcactgggctaggcattgaagctacacatatgaatatgacacagttcctaccctcatgaagctcatagtctaatgagcagacagacatgttaaaggagattgaaataTTAATCTGATGGAGCCTATACTTTCCTGTAGTTCAGAGAGGACAGCTGTCATCCTGTCCTGTATGGAACATTTCATAGTGATGGCAACTGCTTCTTTTGGTTCCTGTCATTGTTTTGTTTTTTAATCAAAATAACACTAACAAACTCTGGCCTAAGTATTAATGTAAAAGTCCTAAGTAGTGCAGACGGAGTATCTTGTACATAAGGAGTGCttccttcagcaaaaatgtattgatgtccagtctgagccagggactgtgtgcactgagaacagttatgatataaaGAGCTTATATAAGTTTAAAGAGGTTTTTAAAGAGTGGTCAAGAAATACAGCTGCAAAATAATGATTGCAAatatatatatatatactataGTTTATGCAATAGTATTTTTGAATAAGTCAGAAAATAGCATATTTTAAGTTGTCATTGTAGTCATAGGGACAAATTCTTACTTTAAGGAACTGATCAAAGATATACCATATGTTTGCATAATTCACTGTGATTGAATGTGGGAAAGCGGGGAAGAAATCACATAAAAGAAGAAAGAGGTCATTATTTGCACAGGTATTGATTTAATTGGCGTTCTGAATACAACTTGGATGAGTTCATGGGGTCTAAGGGTCTGGCCACCTTGGAAGAACTGGGCACACATGGCATGAGCTTCGTGTTGGGTACCTTCAGGGATGTGTTGGCAGACTCAGCAGGTTTCCCTTTTCCTGGCTTCTCTTGCATAACAATAACATACATTTGGAGGATGAACAATGTATAATAGTGATAAGTGTAAGCTTTTTTTCTAAAATATTTGGTCATTAGTGTGAATGCAGCATCTTGGTGGGTGGGTGGAGGGATTGTTGTTGGTTCAGAGCAAATGTCCATGAATATGAGAGAATTGAAAATAATACAATAAAGGATTTTGTACATCCCTTATCAGTGGAGAAGCCTGGAAGATTTAGCTAGCCCTGAATGTGCAATTGACTGTATGATTTTAATGAAGGTTCCTATCCCCACCCCCAGGATGAAAACACCGTTCTTCATCTTTAACCTGGCAGAAACTGCTCACATGCCTTCAAAAGTGAAAGCTCAACTCTACGCTCAAGCATATGACGTATGTTACACTTTTATATGTAGATATAGATATATTTGGTGGGAAGGTGATGGTGATTGTTCAGAATGGATAGAGGGTATATCACATTAGAATTTTTATTATTTTATTTCTCTCAATTTGGGTGGTATAAAGCAGCACATATGAACAAATCCTCAGTTGTATCACAGTATCCAAAGTAAATGGCtgtggtaggcagaataatacctcccacccaaaaaagatgtctagtcctaatctccacaacctgtgaatatgttacctatgtaacaaagcagggggtggtggggattaagttaggtgtcttgagacagggggttaccccagattatccaggtgggcccaacataatcataaaggtcctcatgaaagggaagcaggcaggtcagagtcagagaagtatacatgatgcagaagcagagggcagagagagagaaacttgaactttgcagatggaggaaggagccaggagtaaaagagtgcaggccacctctggaggacgttggaaacagagtctcctctagagcctcctgaaggaatgcagttatgctggctttatgacttctcaccttcagaagtgtgagataataaatgtatgttgtttatttgttacagtggcaataggaaactaatataATAGCTTCATTTAAAACAAGTTCTAGCTGGTTACTGCCTCTGCAAAGGTCATGACCCTGGCTACACTTGAAATGATAGGGCCTTGGCTTGTTGAGATTTCACGAGAAGAGATGATAAAGAGTCATGGAGGGTGGCTCTGTCTTTTAACTGTGGCCCCAGGAAGCCAAACTAACCTTCGGAAGACACAGCCACGCTGAAGGTCTTGCACAAATCGGTCCTTTCTGATGGGAAGTGGGAGCAGATACAAGAGGCTTGCTGTGGCACTACTGTAACCAAGTCTCTGCTTTGCTATGACTTACGGCACTGGCCACTTCAGACACTTGCAGAGTCTGCTCTATAGGAAACTAATATCCTGACAAGGGCCAATGAAAACAGAGGGTAGGACCTGTATATATGAGCAGCTGAGATATTTCTGCCATCTTTAGACTGCTGTGGTTCTACTCAGCCAGGACAAGTGTTTGGTGCTAAGACAAAATAGCATGGTGTCCAATCAGTATGACTACTTTTACTCCTCAATTGTGATCTCTGGTTCCTTATGTATTCACTTattcattcactcacaaagcatttctcgagcacccactccatagcaaatagtgtgttggagacaaccaagtcttatccctgctatcaaaaaggtggcaggctagagagggagatggaagatcaagtcctcagtcacagttcagtcttgtgagtgctgtgagaggcacacaagggtgctacagaaacccagagccctggaccagagcaagctgggaagtaggctggtgagggagggaggaagggaaggcttccagagaggatgtcattggagtgtcatcttgaaagatcagaaggagctaaccaaacagatggtagggcaaggcagcaagagagggaggggagagcagtccataagaagcaagccatgggggcaAAGGCAGATCCCTCCGAGACACCCCACTTGAGGATAGCAAAATACCTGATTATAGAAGGCAGCATGCTGgagttctgtctggcagtaaggaggcccagcttctaggcccactctgccattagttgtcaactgtgcatcaaagaacctttccaggccttgattttttttctaaaaaagaaaaaaaaaagggctttaaacttgaaaagatctcctttcacataataatcctgtttatctctaataccttgtaattctatgaAAAACAAGTAGTATTTAGTTGGGAGAAAACTGAGACTTACTTACTGATACTTTATATTCTCATCAGCGACCTCTTCTATGGTCAGTTGTTTGTTAGGCTACTACTAAAGCTCATTTGTGGATTTATTGTCCCTTTGGGTCAGAGAGCTCTGTTTTTTTTCAGTGAATACAGATTATTGGTATCTCCTTTGCACATAGTCTCCAGATGTGTGACAATGTTTACAAGACAAATGAGGCCAATTACTTCATGGTAATTACTGAATTACCACCCCCAGTGCTAGTTTTTCAAGAATGTTCTTCTTAGGTGTAAAGAATATATTTCTGCTGTTTATATTATCCTACTCAATAGCTCATACAGAATATTAAGTTCAGGTGACATCAGGGAGCAGGGCAGGGCGTAGGCAATGCTATAGGAATAAATTGGATAATTTGAAGGTGTCCCCAACTAACAGAATACATCCACCAAGACTAATATCACAGCAACACATGTATATAGAGGAGGAAATATAATTCCACATAACGAAGAATGATGGGCTTCTCAAGATATGGTACATGTGACTTAATAGGACATCTAAAATAAGTTGATAATGTGTCAGTAACAAAATATTCCAGAAAAAGGTAGCACAGTTGTCCTGCTGCCTGAAGACTAGTAGGTGGGTCATGAATGAGCCTCCATTCTCTGGAGCAGTTGGGGAAATGCTCCTGGAAGTGTTGGCATCTATTTTGGACTTCAACACCTtagtgcagggtggtgggttggggatggttaataggtacaaaaatatagtgagacagaatgaacacaatctagtatttgatagcacaacagggtaactacagccaaccagggtaactacagccaacaacattatgatacatttaaaaataactaaaagagtataattggattgtaacacaaagaagggataaatgcttgaggtgatggataccccatttactctgatgtgattattatgcatggaggcctgtatcaaaatatctcatgtaccttataaatatatacaccaactgtgtacctgcaaaaattaaaGTAACAAACATCAATCTAACAGGTCTATATTTGTATAGAAATATGTAGTATAggaggtggagccaagacagccaaataggaacagctccagtctacagctctcagcatgagcaacgcagaagacgggtgatttctgcatttccaactgaggtaccgggttcatctcactggggagtgccggacagtgggtgcagtgcaccatgtgtgagccaaagcagggcaaggcattgcctcacccaggaagcgcaagggggcagggaattccctttcctagtcaaagaaaggggtgacagacagcacctggaaaatcgggtcactcccaccctaatactgtgcttttccaatgggcttaacaaacggcacaccaggagattatattctgcacctggcttggagggtcctatgcccacagaacctcactcattgctagcacagcagtctgagatcaaactgcaaggtggcagcaaggctggaggaggggtgcccgccattgctgaggcttcagcaggtaaacaaagcagctgggaagctcgaactgggtagagcccaccacagctcaaggaggcctgcgtgccttcctgcctgcctctgtaggctccacctgttggggcagggcacagacaaacaaaaggcagcaatatcctctgcagacttaaatgtccctgtctgacagctttgaagagaatagtggttctcccagtatgcagcctgagatctgagaatgggcagactgcctcctcaagtgggtccctgacccccgagtagcctaaatgggaggcaccctcccagtaggggtggactgacacctcacacagccgggtactcctctgagacaaaacttccagagggacaatcaggcagctgcatttgcagttcaccaatatccgctgttctgcagcctccactgctgatacccaggcaaacagggtctggagtggacctccagcaaactccaaaagacctgcagctgagggtcctgactgttagaaggaaaactaacaaacagaaaggacatccacaccaaaaacccatctgtacatcaccatcatcaaagaccgaaggtagataaaaccacagagatggggaaaaaacagcagaaaaaccagaaactctaaaaatcagagcacctctcctcctccaaaggagcacagctcctcaccagcaatggaacaaagctggacagagaatgactttgacgagttgagagaagaaggcttcagaagatcaaactactccaagctaaagaaggaagttcgaaccaatggcaaagaagttaaaaaccttgaaaaaaattaattagacaaatggataactagaataaccaatgcagagaagtccttaaaggacctgatggagctgaaaaccacagcacgagaactacatgacaaatgcacaagcctcagtagccaatgcgatcaactggaagaaagggtatcagcgatggacaatgaaatgaatgaaatgcagcgagaagtttagagaaaaaagaataacaagaaacaaacaaagcctccaagaaatatgggactatgtgaaaacaagaaatatgggactatgaaaagaccaaatctatgtctgattggtgtacctgaaagtgacaggaagaatggaaccaagttggaaaacactctgcaggatactatctaggagaactttcccaacctagcaagtcaggccagcattcaaattcaggaaatacagagaacaccacaaagatactcctcgagaagagcaactccaagacacatgattgtcagattcaccaaagctgaaatgaaggaaaaaatgttaagggcagccagagagaaagatggggttacccacaaagggaagcccatcagactaacagcagatctcttgggagaaactctacaagccagaagagggtgggggccaatattcagtattcttcaagaaaagaattttcaacccagaacttcatatccagccaaactaagcttcataagtgaaggagaaataaaatcctttacagacaagcaaatgctgagagattttgtcaccaccagacctgccctaaaagagctcctgaaagaagcactaaacatggaaaggaacaaccagtaccagccactgcaaaaacatgccaaatggtaaagaccataaaggctaggaagaaactgcatcaactaatgaggaaaataaccagctaatatcataatgacaggatcaaactcacacataacaatactaaccttaaatgtaaatgggctaaatgctccaattaaaagacacagactggcaaattggataaagagtcaagacccatcagtgtgctgtattcaggaaacccatctcacgtgcagagacacacataggctcaaaataaagggttggaggaagatctatcaagcaaatggaaaacaaaggcagtggttgcaatcctagtctctgataaaacagactttaaaccaacaaagatcagaagagacaaagaaggccattacataatagtaaagggatcaattcaacaagaagaactaacctaaatatatatgcacccaatacaggagcacccagattcataaagcaagtccttagtgacctgcaaagagacttagactcccacacaataataatgggagactttaacaccccactgtcaacattagacagatccatgagacagaaagttaacaaagatatccaggaattgaactcagctctgcacgaagcggacctaatagagatctacagaactctccaccccaaatcaacagaatatacattcttctcagcaccgcattgcacttattccaaaattgaccacatagttggaagtaaagcactcctcagcaaatgtaaaagaacagaaattataacaaactgtctctcagaccacagtgcaatcaaactagaactcaggattaagaaactcactcaaaaccactcaactacatggaaactgaacaacctgctcctgaatgactactgggtacataacaaaatgaaggcagaaataaagatgttctttgaaaccaacgagaacaaagacacaacataccagaatctctgggacacatttaaagcagtgtgtggagggaaatttatagcactaaatacccacaagagaaagcaggaaagatctaaaattgacaccctaacatcacaattaaaagagctagagaagcaagagcaaacacattcaaaagctagcagaaggcaagaaataactaagatcagagcagaactgaaggaaatagagacacaaaaaacccttcaaaaaaatcaatgaatccaggagctggttttttgaaaagatcaacaaaattgatagaccactagcaagactaataaagaagaaaagacagaagaatcaaacagatgcaataaaaaatgacaaaggggatatcaccatcaatcccacagaaatacaaactaccatcagagactactataaacacgtctatgcaaataaactagaaactaatctagaagaaatggataaattcctggagacatacacgctcccaagactaaaccaggaagaagctgaatgtctgaacagaccaataacaggctctgaaattgaggcaataattaatagcttaccaaccaaaaaaagtccaggaccagatggattcatagccgaattctaccagaggtacaaggaggaactggtaccattccttctgaaacgattccaatcaatagaaaaagagggaatcctccctaactcattttatgaggccagcatcatcctgataccaaagcctggcagagacacaacaaaaagaattttagaccagtatccttgatgaacattgatgcaaaaatcctcaataaaatactggcaaaccgaatccagcaacacatcacaaagcttatccaccatgatcaagtgggcttcatccctgggatgcaaggctggttcaacatacgcaaatcaatcaatgtaatccagcatataaacagaaccaaagacaaaaaccacatgattatctcaatagatgcagaaaaggcctttgacaaaattcaacaacccttcatgctaaaaactctcaataaattaggtattgatgggacgtatttcaaaataataagagctatctatgacaaacccacagccaatatcatactgaatgggcaaaaactggaaacattccctttgaaaactggcacaagacagggatgccctctctcaccactcctattcaacatagtgttggaagttctggccagggcagtcaggcaggagaaggaaataaagggcattcgattaggaaaagaggaagtcaaattgtccctgtttgcagatgacatgattgtatattcagaaaaccccactgtctcagcccaaaatctccttaagctgataagcaacttcagcaaagtctcaggatacaaaatcagcatgcacaaatcacaagcattcttatacaccagtaacagacagagaggcaaatcatgagtgaactcccattcacaattgcttcaaagagaataaaatacctaggaatccaacttacaagggatgtgaaggacctcttcaaggagaactacaaaccactgctcaaggaaataaaagaggatacaaacaaatggaagaacattccatgctcatgggtaggaagaatcaattgcgtgaaaatggccatactgcccaaggtaatttatagattcaatgccatccccatcaagctaccaatgactttcttcacagaattggaaaaaagtactttaaagttcatatggaaccaaaaaagagcccacattgccaaatcaatcctaagccaaaagaacaaagctggaggcatcacactacctgacttcaaactatactacaaggctacactaaccaaaacagcatggtactggtaccaaaacaatatagaccaatggaacagaacagaggtctcagaaataatgccacatatctacaaatatctgatctttgacaaacctgacaaaaacaagcaatggggaaaggattccctatttaataaatggtgctgggaaaactggctagccatgtgtagaaagctgaaactggatcccttccttacaccttatacaaaaattaattcaagatggattaaagacttacatgttagacctaaaaccataaaaaccctagaaaaacctaggcagtaccattcaggacataggcatgggcaaggacttcatgtctaaaacaccaaaagcaatggcaacaaaagccaaaattgacaaatgggatctaattaaacttaagagcttctgcacagcaaaagaaactaccatcagagtgaacaggcaacctacagaatgggagaaaatttttgcaacttactcgacaaagggctaatatccagaatctacaatgaactcaaacaaatttacaagaaaaaaaacaaccccatcaacaagtgggtgaaggatataaacagacacttctcaaaagacatttatgcagccaaaaaaacacatgaaaagatgctcatcatcactggccatcagagaaatgcaaatcaaaaccacaaggagataccatctcacaccagttagaatggcaatcattaaaaagtcaggaaacaacaggtgctggagaggatgtggagaaataggaacacttttacactgttggtgggactgtaaactagttcaaccattgtggaagtcagtgtggtgattcctcagggatctagaactagaaataccatttgacccagccatcccattactgggtatatacccaaaggattataaatcatgctgctataaagacacatgcacacatatgtttattgcggcactattcacaatagcaaagacttggaaccaacccaatgtccaacaaagatagactggattaagaaaatgtggcacatatacaccatggaatactatgcagccataaaaaatgatgagttcatgtcctttgtagggacatggatgaagctggaaaccatcattctgagcaaactatcgcaaggacaaaaaaccaagcaccacatgttctcactcataagtgggaattgaacaatgagaacacatggacacaggaaggggaacatcacactcgggggactgttgtggggtgggggtaggggggagggatagcattaggagatatacctaatgctaaatgacgaggtaatgggtgcagcacaccaacatggcacatgtatacatatgtaacaaacctgcacgttgtgcacatgtaccctaaaacttaaagtataataaaattttaaaaaaTTATACTTAATTTAAAAAATAAAATTGATATCTGTAAAACAACAACAAAAAACTTAGTAGGATTTTGAAAACTGAACAGTTCCTGAATGCCTGCTTTGTGTGAGGCAACATGCTACAGCCTTTACACCCGTGTCTTAtcagaggagggctcaggaagagaaaccactggagaaaaaaggatgatgacaaaaagggtaaagcaactttgaatattttaccaagaggataaaagggtaggagtctgacagtaaccttgatgtatatgaaagtgcatggtgattctttcccattttttctttcttttttattttttataactagagatggggtcttgctttgtgggccaggctggtctccaactcctgatctcaagcctgatctctggcctcggcctcccaaagtgctgggattgcaggcatgggccaccgtgcccagcctcttccctattgtataaaataaagggaactaaggggaaatttgctttaaaaggaagctggacaactgagggttattaactattgaaacaatatatcaaacatgaattgtggaatatttcatgagggtgctatttaaaaatagGTATGCATTTGTTTGCCCTGGAGTAGGAATTGGAAAAATAGATAATATGATTGGGTTTCTTTTAACTAAATTATGTAATGTCTAATTCAAAAAGCACTTGTCCCTTGGAGAAAGCACTATTGTTTTTCTGTGCACTCAGAAAGTCTACAGGTAACTCCTGTGAATACAGCTCTAACTTGACAATCTCCAAGAAAGCTGTGAGATTCCCAAGTAAGCAACTATAATATTCCATTTTGCAGATTTGTGTCTGCGTTTTTGTTTGTTAAATTTTTGATGTTTCCTGTAGAAAACTCAGTATAAAAAAAATTTAACTCTATCCAATTAATACTGTCTCTGATGTTGAAAAATGaaattctaaattcctatgggcaaagttttaactatcaaaattataaattACAGGATACTGTGAAGCTTTTCAGTATCTCACTTTATGGATATCTCTTAAATTCTATCACACCCAGCCTCTCTGATGATGAATTTGTCTGGATTGTTTTATCGTTGCTAGTGTTGTTAGTGTTGTTTTTAATGTAGAGAGAAATTTCTGTCAAAAATGTGGGACAAAAATTTAAATTCCTTCAAGTTCTTTTTCCAGGCAGTCTTCTAAAGAAAGCTGTTTTTTTTTTTTGTTCTCCAACAGCTAAATTTAGAGTTTCAACCCTTCTGCCTGTTGAGTAAATAGCTTTCCATGAATTAAAACTAAATCCCTTCCCCAGAACATCTTTCTGGAGGAAGAGCATTTTGTCCTAACACTGTGTCTTCGGTTTCCCCTGCAACATCTAAAAACCTCAGAAGCAGTTTTAGAAGCAGCATATTTGCCTCCTGCTACTGTAATAATTGCAGTAACATTCTTGGGTTCTCTGCATGGCTTAGCAATGATTAGATTTTTACTGGAGGCTGCTTGAATTTTTTTTTCTTGTTATTAATTCCTCTGTGTTTTTTTGTTTTTGAAAAAAAAAAAGTCAAAGAATAACAATGGAATACCAACATTTCTGCTGTTTTCTAGCTTTATAAGGAGATTGTCTATTTACAAAAGGAGCACCCAGTGAATTGGCACAAGAACTATGCCATCGCCTGTGAGCGGATGCTGCGTCTTCAGGCAAGAGATGCAGATCCTGAAGTGCTGTTATCGGAAACCATCAGACATTTCCGTCTGTACTCTCAGAAAGCACCGAATGACCCACAGCAAGCTGATATTTTAGGTGCTCTAAAGCACCTAAGAAAAGAACTGCAAAGTCTGAGAAATAGGAAAAATGTCTGAGACAGCAAAATATGAAAAACCTGCTCATCGTTCAGCTTCCAAAATTCTGAAGTCTGGAAGTTTTTCCTTCAAGAAAAGAAACTGCATAAAAAATTTAAAACTAAGTCATCTCCCAGATATAAGTATCATGGTCCAGCAGTACTGTTTAATGGGGTATTCAGTGACTAAGGTCTGCTATTTATGCAAAATTCTGTTTATCCCGTGTTACCAAATTACCATTTCAGTGAGAAGCTTTTGAAAAGTCTTCTGACTTCCAGTCTTTCACCAGATGACTGCACTGGATTAGATTCTAGAAGAGAATGAACCATTTTCATATAACTAAATATTGGTCATGAACTGTGTAAGGGCCATGCTTATTGGGATCAGTTTTAAAGTTAAATTCTTTTGATATTAATACCAGACCAAAGACATTTTCTGTTTCCTGGAAAAAAAAAATGAATCATGTTAGGCTTTAGGTGAGAGTACATTTTTTACAAAGTAGCTATAGTTGTTACATAGTCTTACACTTCAAGCTAAACACCAAATGGGTGATATTTTGAAAAAAGTTTGTGTTTTACTGTCTTAGATCGTTCTTGGAAATCACTAAAAAAAAAAAAAGTTAATTTGATGTTTGCTTATTTCAGTTGCAGAAACTGGCGAGTAAAAAAGATTTTGCatttacttaattaattttatatttatgttttatttCTATTTGGACTCAGAGATCTAGACCCAATAATTAGTAGGCTCCTGCTGCCAAAATGCAAAGGGGAAAAAAAGGCAGGGATTGGGGGGGATGGGGAAGTGGCCCAATAAATTCATTTCTGTTACAAGCATCTTTTATACATATTACTAAAGAGAACATAGTAAGAAATGCAAATAATAGTTCTTTATTTTATTATGACAGTTAATTAATAGCAACCTGTTTTAATGAATAAAGTCACTCAGAGTCCTTCAGCACTTCCTAAGTAGAGGCCAGAATCTGTAGGGCTTCTTTTCCCCCCAATTGTATAGCTCCTAGACTCCAAGCACTATATAGGCCCCTGTATAGAAATGCTCACTAATGAAGAGGGAGGGCTAGAAGCTTGTCTGCATTCAAAGATCACTGGTGAGTCATTCAGCAAGAAAAGGCCCCTTACCAGGAATAGTCACAGTTCCGTGGCATTGTACTAGCAAAAGGGTCTGATCAAAGGTCTCCTGTGGAGCTTGCATGGTTCCCTTTCATACTACGACCATAATTAAAACCACTAATTCTCTTTTAAAATGCTGCAGGATGCCATGTAGGCATCTGTCTGGAGTGTCCTTTGTGATGTCATAAGCTGTTAAGGACCAGTGCCGAGGGCTTTTGAGTGAAATGCCAGTCATGAAGGTGCTTCAAGACAAGGGTGCCTCTAAAAGCTTGACAGGGCCTTGACTGCACAATTCGAGCTGAATTTGCCCCTTGTCAGCTGCCAGTAAATAAATCTCAAAGGGGGAAAAGCTGAAGTTTCATTACCTGATCCATGGGGCTTTGTTGGTTTTGGCATCACACAGGGGAAGCTCTTGCCCCTCCATTCTCTGGATTTGAAGATGTCCATTGGAGCCTGCAGTGCCTGGACAGGGTTCAGAGCGGAACCTTTTGAAGAGTGTCAATAGTTGTAACAGTTCAGCTGTTAGGAAGACAAATAAATGGAGGAGCTCATTAATCCGCTTTTGGCTCTCAGTGCCTTTTGCCCTTTTATCACAGCCTTATTAGGCTCCTACTCATCTTGAACCAGAAAAAAATGAATTGAAGTTGTTGAGTACTAATTGGCAAAGACTTTTAATCATGGGCCAAGAACTTTCACTGACTTGAAAGTAACTTCTCCACAGGGAAGGACCAAAAACCTGGTTTACCTTAAAACAAAAACCTGTTGGAGTTCAGCGTGGTGTAAAAATGTAAGGAAGCATTGATAAATTGTCTAAGTTTATCCATTTGAAAGAAATTGTGTAAGATTATGATATTCTCTTTTCTTTAAAAAAAAAAGTACAATAAAATTCAAACATTCCTTAGGAAAGCATTGTCTTTATTGGTTCAGAAAAGAGATTGCACATATGCGTGGTGGTTGTGTTTGTTTCTGAACATCTATACACAGATATGTGAATATTCATCTCTGCATCTACATACGCATGTGGTGTTTGAGGAACCTTATTAAAAGTTATATTTCCTATTAGTAGCCTTAAGAATGGCAAATGAAGACCTCTTTTTGAGACTGTCTGCTTGTAAAAATTTTTTAAATATGTGTCTGTACTATAGAGATATGTGTATGGCTGAATGTGCTTTGTGTATAGATTATTGTCAAATGGTACCTAGATTATTCTATATGTGTGCAACAGTGACTTTGGGCCACTCTCTCTTTGAGAAACCAATGATATGATGGCCCGGAGTAGATAGGATCATAATGATTTAAGTTTCTAAAAACCACTGGTAAATGAAAAACTAGTAAACTGAGCTGAGATTTAGGGATGTTGGGCTTCATTCCCAGATGAACTACTTTGGAGAATCCTTTCCTTTCTATTAGGTGAGGTTAAACAAGTTGCTTTCTTTTTCTTTCTCTTACTTTCCTTGGCTAGTGTACAGACTCCATAAAATCTGATAAAAGGGGTTTCCTGTAGTCTGACCCCCGACATTGAGGAGACTGTAATGGAGGTGACTTCTCATGCAAGATTTGGCCAGCGTTCTAGCAGTGTCCCGGGAGTGCCATGGTTTGGCAGGAAGACAGGAACCCCACAAGGCCAACTTCTGCCTGGACTTCGGCCTGAAGAGCCAGTGGGAGCCAGTGAAACTGTCTGACTCTCCACATGCGTCAGGGCCCTGCCGCCCTGGCACCAAGGCTGGCACGCACCAGAGGGCAAGTGGAGAAGCGGATGGTGGCTCCCATGTTATCTGACTAACCACTGGGTGGGCTACACTCCCTGTGCCCCCGCTGTTGCCTCTGATAGGAGTATGCTTGGTTCTTGGTATTGACTTGCCTTTTTTTGTTGTTTTTTAAAAGCACCCATTTTGTTCAATGCTTCTGTTCTGTTACTCAAAATGTAGCCAAAATAGAAGGGAATCAATTACTAGTGTATTATTTTGAAAGCTTCAAACAGAAATTGTGAAATGTTATTTCTGCTCATATTCTTAGTGTTTTCTCTTGGTAGAATCATAATGTTTAGCCTTTATGATATTTAAAACCCATTTTGAGTGTTAGGTTTATTTTTATGATACTCTGCCGGTAACTTTTAAGTCATCAGGCTAGGATATGAAGAGTAGTTTTTTAAGTTTATGTTTTAAAAGTGAAATATTGTGAATCTTTCATCATAGTTCTCATCAATATCCCTCAGAATTTTTAAATGTTAATGCTTTAATATTTAGGAAAAATTTTATACCAAAGTTGAAAAAAAATAGAATCCTGTTACTCCCGACTTCTGGTGTGTTTTATAAATGCATCAACACAGGATATTACTTAGAATTCTGTTCTAACTGGCTTCAAGTCTTATGGTTAGTTAAAGAAAACAACTTCAACCCAGTAAGAGATTCACATTTTGTTGTGAATGCAAAACCATTCTAATGCTGATACTCACAAACAAATAAGTAATGTTTCCAGGGATTCTGGGAACATCTAAAGGCCAAGATCTTGGCACAGCATTACAGAGCAAACAAGGAGCTAAAGCTTTAGCAGTGATCATATTCAATGAAGACATCATTGTCAGCACCCTCTCAAGGTCTGTTTGATTTGGATCAGCACAGACAGTATTTTTAAAACAGCCCCAGGAATAGTACAGTGTGCTTACTCAGCTATAGAAAATTAAACAGGAATATATCCTGAAAAAGGGGTTTTTCAGGAAAAAAAAAAATTCTGATTGCTCTTCAACAATGTAACATACATTTGATGGAAATTGTATGTACTAGAAAGATTAGCTCATGCCATATTGGAAAACAAAAAAAAGGTGGTGATGCCACATGGGAAGGACAAGTAGCGTTTCCAGCACTGTACATGTGAAGCCAACAATTATTGGCCTGAAAGTGGAGTTCTCTGACTCTTTGCTGCAGATCCAAAGTTAGATGTGAGGGTTAATTTTCAATACAAACATTGCGATGATATTACAAGGTTGAGAAAGTTACAATATAAAGGTCAAGACACAAAGGCACAATTATGGGGCTATACTCCTATCCCAGTGATCCAACCTCACAGAGTAACTGCAGAGTTGCAAGTCTTCTGGTACATAGTTGCCATTAGATGAGGATAAGTATAATAAAAGATACATAGAAATAAGCCAAATCTAAGGTTTAACCATTTCAAAACTTTAGCGTATAAGAAGTATAGGGTGAAGTACAATAGATGGAAATGGCATAAAATTTTTTAATCATTAAGTTCATAAACGTTGCAAACTAATAAATGGAGATTATGTCCTGTTTTTAAAATAACAAACCATAATCATCTTCTATTTAGAAGTGTTATCTGAAAGGGTATTTTTTGAAATGTAACCTTTTAAAGAAGGTACTTGATATTTCTCTCAGCTAAATGAAATATTCCCTTAGATAGTTGAACTGTTGAAGATATCTTTAATACCAGTGATGGTTGTTCACATATAAAAGTGTGTGTGATTAAAACTGAAAGGGGAACACTGCTTGGAAAATCACACCCAGTTTTCTCATCCTTGGATTATGGACCTAAGTGAATCACCCATTACCCTGGATCCTTGAGTATCAGCTAAGACACAGGAATTCAGggccgggagtggtggctcatgcctgtaatgccagcactttgggaggctgaggcgggtggaccgcttgagtccgagagtttgagaccatcctgggcaacatggtgaaacctggtctctacaaaagaaatacaaaaattagcagggcaaggtggcatgcacctgtggttccagctacttgagaggctgaggcaggagggtcccttgagcctgggaggtggaggttgaggtgagctgtgattgcaccactgcactccagccttggtgacagagtgtctcaaaaaaaaaaaaaaaaaaaTTATTATAAAAACTCAAGAGCTTTTAAAAATTACTCTTGCAAAAGCTACAGAAACTTTAAAGAGGATTGTTTATAAATGGAAAATGATTCATTTATCAAAAAACTAGGGTTCCTTAGTCTGACAGGTGAAAGTTTTCAAAACAGTTCGTTCTTAAAAGCATAAAAAACTGAGTTCAATTATGCAGAGCTTAAAACAAGCAACTTCACTGATAGAGAATACTCGTACTTAGTGTTTGTTTTTACTTAGAGTGTCATAATTTTCCCCTAAAATTATAGCATATTCATTCAATATGTGGCTTGTATCTACACAGTTAAGTTTCTCTTTCAGTGATTAGAATTTTAGCCATTAACCTATGCAGTCGCCTGTATCCACCTGGAGGCAGTTCCTCCAGTTGCAGGATTGTGCTTATTTAAACTGATTGTCAAACTGTGGGTCATGAAGTCAATTGAGTGAGAATTGACCAGCTTTTTCATAATGAAATAGAATTAAAAACACCACCATGggccgggcgcggtggctcatgcctgtaatcccagcactttgggaggccaaggcaggtggatcacctgagatgaggagttcaagaccagcctggccaacgtggcgaaaccccgtctctactaaaaaatacaaaatttagccaggcatggtggcgggcTCTGGagcctgggcaacagagcaagactctgtttcaaaaaaaataaaaaataaaaaaataccacaatgcattcgaggtaacaaaggtaagtattgtttcatggaaccttcagtttcatttaaaatgtgtatgcacatatgcatgtgtGTATAACATATATGTCATATATGTGTGTATGTAAAGAAATTGATAAatgtgtgtagagtcaatataaaatatacttattgtaggtcatagtaaaaaaataaatttgaaagtcactgGCTTAGAAGAACTTAACACCAggccaggcacggtggctcacacccataattccagccctttgagaggccaatgcgggtggatcacttgaggtcaggagttcgagaccagcctgggcaacatggcaaaaccccatctctactaaaaatacaaaaattagctgggcgaggtggtgcgcacctttaatctgagccactcaggaggctgctgctcgagttttgcttgaacctaggaagcagaggttgcaagtgagccgagatcgcgccactgcactccagcctgggtgacagagcaagactcttgtctccaaaacaaaaaaaaaaaaaaCAGGACATCAAAAGGGTTAGTAagggatcatccagtgttaactatcacagctaatctagtttaataaatgaagaaactgacatctatactaaacaagtgacttgattactgtcacacagctaggtagtaacagcactgagactaggacacaagcttcttggctcaacctggtacagtttccctactcCAGTCCCAATTACATGAAACCAGCTATATTCCACCATCACCTCTGGCACATTGAAGTCCTCAAATAATGCAGCCATTTTAAAATTAGCATAAACTTGTCTAGGGGTAAATGGTGTGTGAAATCAACTATGTTGCAGGAAATTAAAAGCTATACGTTGAACTTTCCCCCTCTCCTTCAACCCTCCAGAATGTAATTTTTTTCCCCTTTCCTTTTAGACGTGGATAGTTATATCCCTGGCTTTTGACTGAAAATTTTCTTGCCCTTTCTGGACTTCGGAATATATACCCAAATTAAAAGGTTTTAGTGTGACAAGAAAAAAGTCACTTTGAAATCCAGGAACTTATTAGCATAAATTACATTCCAGCTGAATCAGCTGCTAGAAGCTCAATTTGAAAAATGTTGCACTAGTTTATATATTTCTTACCCCTCTTAAGTAGACATCAAAACACAATCATATTTCTGTATTTTAGAGAAAGAAATATGTCCCAGCTCCACTGGAATTAGACTTTACCTCCCAGAAACGGACCCCACCTACCACTGGTATTCATGATTCTTCTATTTGGTTCAGCCACTTTTTAAAAAATATTGAATGTCAGGcgggtgcagtggctcacacctgtaatcccagcactttggtaggccgaggcaggcggatcacctgaggtcaggagttcgagaccagcctgaggtggtgaaaccccatctctactaaaaatacaaagttagccaggtgttgtggcacaaatctgtaatctcagctacttgggaggctgaggcaggagaatcgcttgaacccgggaggcagaggttgcagtgagccaagatcgcgccattgcactccaacctgggcaacaagagcgaaactccatctcaaaaaaaaaaaaaaaaaaaaaaaaaaaaTGTTAAATGTCCACAAGGCAGAAACCTCTTTGAAGACCTAAGTGTCTGATATCCTAAATATGAACCTTATGTATTCAGTGTGTAGGTGACAATGATTTCTCCCAAATTTGACTCTTGGTTTATATGTATGATTTGTGAAAATATAGACTGTAGTAAAAATAGTAATAATAGCTGTTATTATAACAATCTTGGTGACATTTGTTAGCCACTTAATTGCTTCACCTAAATTTCCTTCATTTACTCTCAGAATTAGAAGTAATTTGGCCCTgccgggcgtggtggctcactcctgtaatcccagcactttgggaggctgaggcgggtggatcatgagatcaggagttcgagaccagcctggccaaggtggtgaaaccccgtctctactaaaaatacaaaaattagccaggcaaggtggcagatgcctgtaatcccagctactccgaaggctgaggcagaagaattgcttaaacccgggaggcggaggctgcagtgagctatcacgccactgcactctagcctgggcaaccgagcaagactccatctcaaaaaaaaaaaaaaaaaGTAATTTGGCCCTTCATCTTCGGAGGCAAATAAGTTTGGCACCCCTCAAGAAACGAAAATCCCCTTCTGATGTGACCACATAAGCCATGCTGCATGCACTTTGCGCGTTTGATAAAGATATATAGATTACCTATTTCACAGGGTTCGCTTTTACTAGGACAAAACTTTTCTCTTTCACTTGTCCCTTGCTGAACAAATAAATAGTTGATTTAAAGAGCCTAAACCTGGTAAATATGTGAGCTCATTTGTACCAAGAAAATGTGTGAACAAGACTAGAACTTTATTTTATGGGATCCCATGAAATCCCTTAATAATTGTGCTTATATTGTCATGTGAAACGTGACCTGCTTATAATTTGGATACAATAGAGATTCTATTTTCCTATTTTATTATCATGCACCTGGATGAAGCCAACACCTTAACACCTTCATCTCATCTCTTAAAGCTCCCATAGCCATGTGCTATCTCCTGTGGGAAGTCACTGTGACTTCCCTCCCAGGAAGAGGGGACAACTCTAGTTCATATTGCTTGCACAAAGAAGCACTTGGAAGGATGTGGGTCTGGAGGGTTCATTTTGCCCCTAAAAGAGCAAAGAGCAGAAACAGAGTTCTTTCCAGAAGATAGGATTTTTCTGGATTGCACCAGAAGCACTGTATAGTATAGTgattagactcccagctctgccacttcctcactgtgtgacttggagtaagtttttaaagttctgtgtgggccaagcacagtgattcacacctgtaatctcaccactttgggaggctgagatggaaggatcgcttgaggccaggagtttgagaccagcctgggcaacacagttgagacctcatctctacaaaaaatttttaaaaattgccaagcatggtgtcgtgtgcctgtggtcccagctactcagaaggctgaggcgagaggatcgcttgaacccgggaggttgaggctgcagtgagctgtgtttgtgccactgcactccagcctggggcaatatagtgagaccttatctcaaataaataaataaataaataaagctctgtgtggcttaatttccttttctgtagaatggaaatataatagactacctcatggtgcagctataaaaatgaaaaaggttaatatttataaagtgtattgaacagtgcctatatagACCAACTGCAAGTCATGTTGGCTGTTTTCATTAATATGTCAGTAAAAACAGTTCTTCTCTACTTCCTACTCAGTAAAATAAATGTTCAAAGCCTCCTGGTACTTTGCTTGTCTCTCTAGTATGTTTAAAAACGTCTTTACTAAATATGCATCTGGAaaatttaaataattcaaataaattacaatgataattataaatataaaAACGTTATTTAAATTATGTGAATATCTGGGAATTAGAAGAGAGTAACCAAAAAGCACTAAGCAGTTGAAGAAATGAAATCAGTCCCATTAATAAGAAAAACACATCTCAATCTGTGCACACGCATGCACACACACAAGTAAAAATCGTGTGCACAATTCATTTTCACGAGACCCCATTACCATGACCGTCCTTCCCTCTTTCTACTGGTTTCCCCAAACCATGGCCCACCTGGAAGCAGGCATCTACATTATCTCCTCTTCTTCCCAAACTTAGATTTTACCATCTATATATTTGATCTTAGTCTATTGTCCCCTGCATTCTACCCCCCAGGGACTTCTCAGAGAACAGTCTCCTACCAGGACAGCTTCTGCAGGCGCTTGGAGGACTGGCGTAGGTCAGAAAGCTTGCAGTCCAGAGCACAGGGGCCCTGCTGGACCTTCAAAACCATCCTGGGGGATAGGGTCATAGATTGCTGAGCTGGGATGAGTGGAGTGGCCAAGAGTATGTTTTGTAAATGAGCACCCCATTTATTCACTtttttttttacttttttaaaaatagaggtgaggtcttctatgttgccccggctggtcatgaactcctgggctcaagcaatcctgtcacctcagcctcctaaaagtgttgggattacaggcatgagccaccatgcccatccCATTCACTTACGTTTACTAcatttaataaacattttttgagcttctataatgtgccaggtctgaatacgacgttttcagaggggaaccagacaagggccctgtccccgacagagcttccattccagaaggggagaaagccaAAATGCCAAACTAAAAATCTGCCCAAGGATCTTTGTTCACCACTACTACATTCTACCCAAACAAGGAATGAAACTTGCTTTCTCATTGTTAAAAGTGTTGCTTACGAAATGTTTACCACCACCCTCTCAACCCAAGTTAACAAGTTTCCCACCTGTTGAGATGTCTGCATTTCATTCTTGGGCTATCTGGAGCTTTGCTGAATCCACAAAGGGCTTCACTGGACCCACAAACGGTCATTAGACCACACTTTTATTTTGGCACATCTCTCCCCACCTTCTTTCCCACACCAACATGAGTAATTCTCTGCTTTCTTTGGCTACCCTTTATCCTTCTGCTGGTCTCAGCAACATTGGATTAAAAAAACATTCATGCTGTCTATCTGTGGCAAAGAAATATTCCCACCTCTCCCACTGCCACCCATAGTAACAGAGAAAGGAGGCGAGAGGTAATAAAAGTGTGTCACCTGCTCTTAAGCTTGGTGCCTAACTCTCCTTAAAGCCACCACGCAAATTTCTAGAGGGATGTTGATCTCATTCAGGCTCTTATCCCACACCCTTGCTTAGCTTCATTGCTACAAAAGCAGGCCCTGCTTCCACAAAGCAATgaagggaatcattgcttctgtagcattcttgccaaaaatatataatctcaatttaatttttttgtttgtttgtttttgagatggagtcttactctgttgcccaggctggagtgcaatggggcaatctcagctgactgcatactccacctcccaggttcaagtgattcttgtgcctcagcctcctgagtagctgggaatacaggtgcccgccaccatgcccggctaattttgtattttttgtagagacggggtttcaccatgttagccaggctggtctcaaactcctgaccactcgcctcagcctcccaaagtgctgggattacaggtctgagccaccgcacccggccttaatttaatcatgagaaaacatttcacaaatccaaattgagagactgtctacaaaatacctgaccaggactcttcaaacatgttaaggttatgaaagacaaggaaagacaagagagtgtcctgaatttaaggaaactaaagagacatgacagctatgtgcagtgtgggatcctggattcaatcctaggacagaaaaatactattactattattagacaaagtctcactctgccacccaggctggagtgcaatggtatgatctcagctcaccgcaacctccgcctcccaggttcaagcgattctcctgcctcagcctcccaagtagctggaattacaggcatgtgccaccatgcccagctaattttgtatttttagtagagacagggtttctccatgttggccaggctggtcttgaactcccgacctcagttgatccgcccacctcagcctcccaaagtgctgggattacaggcatgagccatcacgcccaacaaaaaatactattattagaaatagtggtgaaatctgaatttaaatctatagtgtggttaatagtaagtattgcactaatgtcccagcttcttggttttgatcattatgtaagatattaaggtgagtgaagttggatgaagggtagacaggaactttctgaactattgttgcaacttttctgtaattctaaaactatttaggaataaaaGAGGGtttttgttttttggtttttgtttttttttttttttagttttAAAAGCAAGGCACTCCTTTTCCCCCTTTACTCCTTGTCATTCTTTGTTAACTACTGCTTTAGGCCTCAAGACAAACAATAGATAGGACAGTGGTCTTTATGACTTGGGTGCAccaatgatcaaagagacacaatccctaaggccaaaggccacaggccTGCCACCAGCCTAGTCGTTAGGGTAGGTAGCTCTCGACCCTGGGCCTGAGCCTCTTCCTAGTAGCTGTCTAGGTGGACCTGGGTGAGAACTGGGCAGCCCCAGGGAGCCTGAAGCTCTGTTTTCAGCACCTTGGGAGGCTCCGGAGAGGCCGATGGGATTAAATTCCCCTCAAAGCCACTGGGCTCACACCCAGCTTGAAGACAGCAGGATCTAGTCGGGGATTATTCTTCCAGTCCGGGTTTCTCTCTTCAGGCAGCCACTACGGAGAAGAGGGAGTGGAGGCGAAGCACCCTTAATACCCTCATTCTTTCAAAAGATGAGTCAGGTTTTTGTAGCTTCATTAGCATTTGCAGATAAAAATACATTTTAAGTGGCATTATGCTAAGTAATTATTCTTAGAAGATGTGAAATTAAACACATTTTACTCAGCATGAAATTATTCCTGCCACGTACTGAGTTTTGTGACAGCTTGAGAGTTTGGACAGTGGGTTGCAAGAAGGGGAGAAGCAATCTATGTACTTAAAAAAAAAACCCAAAATATTTTACCAAAGGTAAGTCCTTGTAGCGAAATGATTTGGCTGGATGGAATATTAAACCTGCTACTATAAATTTCACGCCTTGCATTCCTAAAGCAGATGCAGAGTGATGATGCCAAAAATTAATTGGAAATAATGCGACTTGCCTTGTGTACTCTATCCAGTAGAGGGCATAGCAGATAAGCATTGTGTGTGTTGGTGACTTAGCAACTGATAAGGCTTGTTTGTAATTGCTTCTGTAAAGATATGTAGCAGCATGCTTGGATGCTTATTTACATTTAGGAATGTGGTTCGGAATAGGAGGTGTAGATTTATAACTTTGGTTTTGTCTGTCAATACGTGGGAGACTTTTGGTTGTTGCAAGCATTATATTTACCAATGCGCAATGTTAAATTGCTGGATTTAATTGTTACAGTACAGTGAATTATTCTATTATTTCTTACTTTTTTATCCCAAGGAAAATTCAAACTTTCCAGGCTTAAGGGCAGGATAAAATGGCTCTGAGCATGTCAACGTCTCAAGAGCACATTATTTTCTTATTGGATTGTATTAACTTTACAGATGGAAATTTGAAGGAGAATTAGAAGGCTTAGAGATGGGGAATTTGGAGAAGAAAAGAATAATGTCCTAAGATTTCTGGAGGGGCTAACTGGTAAGTCATTTTGAAAGCTGCTGATGCTAATTCTCATAGCAAAAGACATAGCAGATCCTAAAATTATCAGGAATGAGGCATGAGGCACAGAATTGCTAAGAAGGAAGTGAATCTTGTGTCACACTAAGAATTGCCAAAGGATTATTCAGGTtctgtctctgtctcgctctctcttctctACCTGTTACAATTGGCACAGATTTTTCTTATGTAAACTCTTAATAGTGCACCTGTCCACAAGCTGGGTGAAGGGTGTTTGGCAGTTCCACTTAGTTTAAAAACCAAACACAGTCTCCTGCCTCAAATACACACATTTGTTCTGAAGGGACAGCAACATGACATATGTAAACAAACATTCATCCATAGGCACTCTGGTTTGCAGCTGAAGGAAAAGCTGGAGGCGGGAGTGGGGACACAACATAATAAAACCAAACAGACAACCATGCTAAAGAAAAAGGCACCAGCCTCCCTCCCACTACTGCCCAGGTGTCAGGTGGCTGCAGGAGGCAACCACAGACTGTCCTGTCCACGCTGGAGGATCCAACCCTGGGCCAGGTACCAGCCTAGTGGGTCTGGAATCCTGGTGGTCGCCACCCCTCCTCCTCCTAGACTCTGCCTCTCCTCTGGAATTCTTCCCCACAATTGTGGATGCTTCCATAGGATCTGAGGTGAGAGGCGTGGGAAAATGAAAAAGGGGAGAAACCACAAAGCCTGCTTCTGGGTAGGGAACCAGGAATGCCCTCGGTGGTGGAGCAGGAGACTTGCTTTTCACTCTGTGCCCTTGTTAGCTCTGAATTTTGTACCATGAGCAAGTGTTACCCAATCTTAAAATGGATAGACAGACAGGTAGTTGGTGAaagaaagaaaaagcaagaaagaaggaaggaagggagggaaggaggaaaggagggagggagggagggagggagggaaagagggaagggaggaagggagggaaggaaggaaTTAAAAAAGGGAAAATTGTAGTGAAACAGGACCTGGCCTAAAGGAATGACTAGCCAATTCCTAGACTTGTTCTCATGGTCAGCCTCTCCCTGCCATGTGAGTGAGTTTCCCCTCTTGTCATAGAGGAATAATTGTCCTTTCTCACAGGCATATGTTCTATTGCAGATTTTGTTATCTTTTCTCCTTTGAAACTTGAGTTTGTTGTTTATATGACACTGTTACTTTACAAATGGCCTTCTCCCGTCCACACATGTGTATGTGGGGGTGGAGTGGGAGTCCTTACTCCTGTGAGAAGGGGGAGAAAGAGGCAGAGAATGGAGAGAGGCTATTCATCATTAGAAAGGTTGTGACAGAAGAATTAGACCTTCGGGATTATAAGTTTAGGTCTCAGGGTGAGTTCAAGTTTAGTGTGAAAGTTAGGGCCCCCAGAGGTCTGCCTTTCATTCACTCCTCAAAATCTGATTGCTGTTACTGCCACAGAAAGTTGTACATGCATCCCAAGTGGCAAGAGCCATGATTTGGCTTCTACATAGCTGCAGCTATCAAGAGAAAGTCTAAATCTTGTCTGTCTTCTCAGATAGCTACTTTTCTTGTCTAAACATCTTTCCGCCAGAAGCTATATTTAATATTGCAAACAACTACTCCCGTGGtatataggtcatggatttattgccaagaacaggatccattccacctagtttaagcattaaatggctgacagaattatgaggagggtgaagagacaggctctaggtttaaccttcccaaagatgactctcaaaacttctctgcagagcccggccaccaacagaactgcggcctttcgcaaccaggaagctccctaacaagatgggaagctactgcttttgtcccaaactccagaaccatgacacccctgctatatctcagaagccaccgtggtcaggaagttactgcaactgctacaaccagaaccacccctgtgcccactagaatccacacaaattaaatggcttccccaacactgcctttcaacacacacacaaagctactgattagacacagggaaactatctccgactaggcttgcccgcaaaaacaatagaaaatgtaggctgtgtctcactgccaccttctgaatcccacatgagtgtatctgaatggccgaactacgctcacatccagaaccctcagtgcaagggcatttgggaagcacagttttaattgtccagcctctgcagtacacaaaacattctagaaggcagttgcattggccgggcaccctggctacgcctgtaatcccagcactttgggaggccaacgcgggcggatcagctgaggttgggagttcgagaccagcctgaccaagatggagaaacccccgtctctactaaaaatacaaaattagccaggcgtggtggcacatgcctgtaatcccagctactcaggaagactgaggcaggagaatcgcttgaacccaggaggcggaggttggggtgagccaagatcgcgctgttgcccaccagtctgagcaacaagagcaaaactctgtctcaaaaaaaaagcagttgcattaaatgttgagcatcgatacactgtatttgtcacTCTTTAACAATTACAGAAATGAAAACATGGGTTTTATTTTGAAAAAGCATATTTACAAACTGTACACAAGAGTAAATTTTTTTTAACCAAAAACAAATGCACATTCAGAAGTGGGTAAATTAGTAATGCAGGAATTTTCAACAAGGGTTTATGGGTACTGAGATCAACCCAAAATAATGAGGGTTAAGAATTATATATTTCTggccgggcatggtggctcaagcctgtaatctcagcactttgggaggctgaggcagcaggaagatcatctgagatcaggagtttgagaccagcctggccaacatgTATCTATTTATGTGACATCCAAAGCACACTAATCAGTACATTGATTAGAACATGAGGAAGAGCAAAAGATAGCCAGTTTTACCCAATAATGACATGAAAGCTAGGTGAAGACTTCTCTGAAGACTAGAACTGAGAAGGGAAACTATTATTTCATCAATAGAATGGGTTAAAGATGCAGCGTGATCTTGCCAGTCTGCAGGAATTGGATCTGCATGCATGAGCAGTTGGAATCAGCATACTTCCAAAAAGATCAGAAGGCCTTCGTGTAGAAAAGTAATGCAAAACAGAAACCACAACATCTTCTGTTCTTTTTCGTCATTTGAGAAGCCATTCTAGGACTACTTGGGTGTGAGTGGAAGCACATCCTTGGGACACTGCCCAAAGGCAGAGTAGGAAGTATGAGAACTGGGACAGTTATTTGTGCTACAAGAAAAGAGCAGCTTACAATAACAATTTCTGGGAATTCAAAATCAAATGACCGGGGAGACTCCAAGACACACTCTTCCAAGGCTCTCAGAAGCTGGATGAGCACTTATAAAGAAAAGCATTCCCTATGACCAAAACACAGAGATCACTGATTACAACAGAGACAGGGGGTGCAAAGGAGCAGAAAGACACGGCAGAAATTATCCTGCGGGGAACCCTCCCAAAGCCTCATGTAGTTCGTGATGGAAGTCAGAAGTCCAACTGAGAAGCAGAGCATGAAACAGGGGTCTGGGTCCTGGTGGCGGTGCAGAGTGCAGTTCCCTGATGTCCCCCCGCATCAAGGTCAATCCCGTTGTGCCTCGAGGGGAAGCAGAACCAATTGTTTGAAAGCTTTGAGTTACTTATGACTTTCAGCATAGACATGAACTGTTTTAATATTTTCATTTATTTACGTATTTCACATTTTTAAAAAGTATCTGGCATGTGTCAAGTAATATGAAAAACAGGAAActttaaggggtttatacttttatgaggacctaagataggtaaaggagcaattgcattataaggtgtacttgctcttataagggaaacatagagggttgtacgggaaacctatctagactcagagtggaggatgtcaaagaaagctggctggcagagcggactaactgagctgcagggaggaggagagttagcaggagagggcagatgactggggagtgctagagtaggaggggaaagaggattcgggaacagggatgagcaagtgcaaagccttgaaggggagagaggacagcacgttcaaggaatttataaagtaattctgagtggttgaaatgcagaatttaggacaggtgtggtggctcacacctgcaatcccagctcttgggaaagatgaggtgggaggatcgcttgaggacaggagtttgagaccagcctgagcaacacggtgggacccccaccactaccccaccccagcccccactccctgtctctgaaaaaagaaaaagaaaaaaactagctgggtgtggtggtgcaagcctgtagtcccagctactccagaggctgaagtgggaagattgcttaagcccgggagtttgagggcacagtgagctatgatcgcactactgcactccagcctgggtgacggagcaaaacctgtctcaaaaaaaaaaaaaaaagtgcaggatttgagtggaagtggcaagaaatgaggctagtgaagcataaaccagctgataacgatcttgagagccacagtacagagttgggttttatctggaggacagtgggaaactaggggaaggactttaagctggagagtgataccacgtaaactttgaatgaccgtggtgacagcaatgtggagaatagaccgggttggggtggggcacgatgggaagaaaagaacccagtcagaggtggttgcacttacaccgggtgatgatgtggcctgaactaggtcgataacagtggggagaaagaaaaatgaacatattctagaAACCAAACCCTGAACAGACTCTTAACACTGCCCGGCCATCCTGGCAAGCATGACTTCTCACTCTCCAAGACAAACATCCCAAGCTTTCTTCTCTCCACACTTCAGCTCCCACTCCTCCACCTCTTAGCTATCTAATGTAGTTGAGAAAATAGAAGCCTTTAGAGAGGATTTCCCTTTTCCCTTATATCATACCTGTCTGCTTCTGTGTCTATCTTCCCCTCTTCCGCTCCTGAACCACCGCCTTCTCAAGGActctctctgttccttcagttctctcctcttctgtatcctttcgtcgctctccctctctctctctttctcCATATCACACACCCTGGTGTTCTCCATCTGGAGAGACGCTTTTCCTTACACTTCAGCCGTttcctattataccctattaagccttcataccctggggctgcctctttcccagctcacctgggttcattctactccttgcgcctacacttcagccacactggctccaaacactccaagccttttcacctgagggcctgtgtaaaaactgccctgtatgcctgtaaAAGAGTGTTCCTTTGTACTAGGTTGAGTAGTATCTCCCCAAAATTCTGGCCTTATTTGAAAATAGTGATTGACAGTGATATAGTGACAGTGATACAGTGACAGATCACTATTTAAAATAGTGatttgaaaatacagattgacatctatagatgtcaatttgttaaggtgaaatcacactggattagggtgaaccctaaatccaatgactagtatccttgtaagaggagaggacacacagagatagagacatggagggaatgtgaccatgtggaggtggaaactggagtgatgtgtccataggccaaggaatgacaaGAAGAGTCAGTTTTGATTgaggagaaaggaaaaaaaaaatggttaggcagacagggtggctcttcggttgaatcctttcaaacaaaagaacagccggcagggacagataagggaatttgcacaggagggcttacctgagacatgccacagccatatagataagaaagcctgcacaggtgacttgcccagacatgcccgcaatggaaaattccattccctgacacatgtgcagtaaggggaacaaagcaatatggaataactcaagctaagggcccacacgcgcattaggaagatggggtggagctaccagaaatttgtgccttaggcagatgagacacccggccctcattgatttcctataaaagcctttgtacgcaattgtgaaaatggcagccctcttctgggtaccctctctgcagcagagagcttctttcccttattaaacttttgctccaacctcacccattgtgtccaccgtcctgagacaaagaactctggatgataccttataatgagaaactgctacattgtggcacattggtgagactGTAAcagttggagggaatttgttactgcagccctaggaaattaatacaTCATTCTTCACCCATGactcatcccttctcaggcatctcttcctaaggaggtccttccctggcccgcttacctaagagtattgctatttttctcctttgttaaaactagtttattttctttatagcccttagcatgagtggaagtcatacaggtatagtttcatttttagttttgttatctgtttcacacgctaaactgtaagctcccagagggcagacaccattatctacctttctagtactggcctgaaacatggtcagtatccagtaaatgtttgacaaactagtgaaATAGtgaatgaatgaatgaatgaatgaatgaatgGGATATTGAGAAGCTAGAGTGGATAGGACTTGTGACTGCTTTGATGTGAGGGGAAGGGGCTGCAGGGGCAGAAATTCCAGGTTCTGGCTTCAGTCCTTGGTGGATTTGGGTGTCCTGAGCACAAGAAGAAGAGCAAGTTTAGAAGAAGGATAATGAGCTCAGTGTTGGAGTTTTGAGTCTCAGGTGCCCATGGGGCATTAAAAATAGATGTCCAGTAGCTGGTATCCCTGTTCCTGCCtttctctgctctcactcctaccccctcctcagtctatccgcaacacaatagccagaaggagcctttagaaatacaagcagatGgggggaggagccaagatggccgaataggaacagctccggtctacagctcccagcgtgagcgacgcagaagacgggtgatttctgcatttccatctgaggtacccggttcatctcactagggagtgccagacagtgggcgcaggccagtgggtgtgcgcaccgtgcgtgagccgaagcagggcgaggcattgcctcacctgggaagcgcaaggggtcagggagttccctttccgagtcaaagaaaggggtgacggacgcacctggaaaatcgggtcactcccacccgaatactgcgcttttcagaccggcttaaaaaacggcgcaccacgagactatatcccacacctggctcggagggtcctacgcccacggaatctcgctgattgctagcacagcagtctgagatcaaactgcaaggcggcagcgaggctgggggaggggagcccgccattgcccaggcttgcttaggtaaacaaagcagccgggaagctcgaactgggtggagcccaccacagctcaaggaggcctgcctgcctctgtaggctccacctctgggggcagggcacagacaaacaaaaagacagcagtaacctctgcagacttaaatgtccctgtctgacagctttgaagagagcagtggttctcccagcacgcagctggagatctgagaacgggcagactacctcctcaagtgggtccctgacccctgacccccgagcagcctaactgggaggcaccccccagcaggggcacactgacacctcacacggcagggtattccaacagacctgcagctgagggtcctgtctgttagaaggaaaactaacaaacagaaaggacatccacactgaaaacccatctgtacatcaccatcatcaaagaccaaaagtagataaaaccacaaagatggggaaaaaacagaacagaaaaactggaaactctaaaacgcagagcgcctctcctcctccaaaggaacgcagttcctcaccagcaacggaacaaagctggatggagaatgactttgacgagctgagagaagaaggtttcagacgatcaaattactctgagctacgggaggacattgaaaccaaaggcaaagaagttgaaaactttgaaaaaaatttagaagaatgtataactagaataaccaatacagagaagtgcttaaaggagctgatggagctgaaaaccaaggctcgagaactacgtgaagaatgcagaagcctcaggagccgatgcgatcaactggaagaaagggtatcagcaatggaagatgaaatgaatgaaatgaagtgagaagggaagtttagagaaaaaagaataaaaagaaatgagcaaagcctccaagaaatatgggactatgtgaaaagaccaaatctacgtctgattggtgtacctgaaagtgatgcggagaatgaaaccaagttggaaaacactctgcaggatattatccaggagaacttccccaatcta'.upper()

    otx2_wt_seq = (extra_seq + otx2_wt_seq)[:524288]

    for del_name in del_seqs.keys():
        del_seqs[del_name] = (extra_seq + del_seqs[del_name])[:524288]

    all_1hot = {}
    all_1hot['wt'] = dna.dna_1hot(otx2_wt_seq)
    for del_name in del_seqs.keys():
        all_1hot[del_name] = dna.dna_1hot(del_seqs[del_name])

    all_preds = {}
    for variant in all_1hot.keys():
        all_preds[variant] = predict_tracks(models, all_1hot[variant])[0].mean(0)

    true_vals = pd.DataFrame(dict(
        zip(
            pd.read_csv('data/ground_truth.tsv', sep='\t', index_col=0)['meanexpressionscoreavg'].index,
            pd.read_csv('data/ground_truth.tsv', sep='\t', index_col=0)['meanexpressionscoreavg'].values
        )
    ), index=['observed_mean']).T

    all_tissues = list(targets_df.description.unique())
    all_preds_otx2 = np.zeros((len(true_vals.observed_mean), len(all_tissues)))
    for i, tissue in enumerate(all_tissues):
        curr_targets = targets_df.loc[targets_df['description'] == tissue]['local_index'].tolist()
        otx2_sums = {}
        for variant in all_preds.keys():
            values = all_preds[variant][:, curr_targets].mean(1)
            otx2_sums[variant] = values[(56799905 - 56634001 - 512) // 32:(56810479 - 56634001 - 512) // 32].sum()
        curr_preds = pd.DataFrame(otx2_sums, index=['prediction']).T
        obs_vs_pred = pd.concat((curr_preds, true_vals), axis=1)
        all_preds_otx2[:,i] = np.array(obs_vs_pred.prediction)
    all_preds_otx2 = pd.DataFrame(all_preds_otx2, index=list(obs_vs_pred.index), columns=all_tissues)
    all_preds_otx2.to_csv('predictions/otx2_predictions_in_tissues.csv')

if __name__ == '__main__':
    main()

